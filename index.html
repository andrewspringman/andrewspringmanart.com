<!DOCTYPE html>
<html>
<head>
<title>ANDREW SPRINGMAN ART</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="axios.min.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-colors-camo.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif;}
body, html {
    height: 100%;
    color: rgb(33, 33, 33);
    line-height: 1.8;
}

/* Create a Parallax Effect */
.bgimg-1, .bgimg-2, .bgimg-3 {
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
}

/* First image (Logo. Full height) */
.bgimg-1 {
    background-image: url('2009030601parallaxfade.png');
    min-height: 100%;
}

/* Second image (Portfolio) */
.bgimg-2 {
    background-image: url("2009030604parallaxfade.png");
    min-height: 300px;
}

/* Third image (Contact) */
.bgimg-3 {
    background-image: url("perl2014011903parallaxfade.png");
    min-height: 300px;
}

/* Page title image  */
.titleImg {
  background-image: url("2009030604parallaxfade.png");
  min-height: 200px;
}

.max90 {
  margin-left:5%;
  margin-right:5%;
  //max-width:90%;
}

.galleryImg {
  max-width:90%;
}

.faqButton {
  white-space: normal;
}

.col90 {
  margin-left:5px;
  margin-right:5px;
}

.w3-wide {letter-spacing: 10px;}
.w3-hover-opacity {cursor: pointer;}

/* Turn off parallax scrolling for tablets and phones */
@media only screen and (max-device-width: 1024px) {
    .bgimg-1, .bgimg-2, .bgimg-3 .titleImg {
        background-attachment: scroll;
    }
}
</style>
</head>
<body id="theBody">

<script>
var host = 'http://andrewspringmanart.com';
var api = host + '/directus/api/1.1/';

function navigation(home = false) {
  contact_link = home ? 'index.html#contact' : 'index.html?page=contact';
  return '' +
  '<!-- Navbar (sit on top) -->' +
  '<div class="w3-top">' +
  '  <div class="w3-bar" id="myNavbar">' +
  '    <a class="w3-bar-item w3-button w3-hover-black w3-hide-medium w3-hide-large w3-right" href="javascript:void(0);" onclick="toggleFunction()" title="Toggle Navigation Menu">' +
  '      <i class="fa fa-bars"></i>' +
  '    </a>' +
  '    <a href="index.html" class="w3-bar-item w3-button"><i class="fa fa-home"></i> HOME</a>' +
  '    <a href="index.html?page=artist" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> ARTIST</a>' +
  '    <a href="index.html?page=gallery" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-th"></i> GALLERY</a>' +
  '    <a href="index.html?page=news" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-newspaper-o"></i> NEWS</a>' +
  '    <a href="index.html?page=faq" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-question-circle-o"></i> FAQ</a>' +
  '    <a href="' + contact_link + '" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-envelope"></i> CONTACT</a>' +
  '    <!-- a href="#" class="w3-bar-item w3-button w3-hide-small w3-right w3-hover-red">' +
  '      <i class="fa fa-search"></i>' +
  '    </a -->' +
  '  </div>' +
  ''+
  '  <!-- Navbar on small screens -->' +
  '  <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium">' +
  '    <a href="index.html?page=artist" class="w3-bar-item w3-button" onclick="toggleFunction()">ARTIST</a>' +
  '    <a href="index.html?page=gallery" class="w3-bar-item w3-button" onclick="toggleFunction()">GALLERY</a>' +
  '    <a href="index.html?page=news" class="w3-bar-item w3-button" onclick="toggleFunction()">NEWS</a>' +
  '    <a href="index.html?page=faq" class="w3-bar-item w3-button" onclick="toggleFunction()">FAQ</a>' +
  '    <a href="' + contact_link + '" class="w3-bar-item w3-button" onclick="toggleFunction()">CONTACT</a>' +
  '    <!-- a href="#" class="w3-bar-item w3-button">SEARCH</a -->' +
  '  </div>' +
  '</div>';
} 

function footer() {
return '' +
'<!-- Footer -->' +
'<footer class="w3-center w3-black w3-padding-32 w3-opacity w3-hover-opacity-off">' +
'  <a href="#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>To the top</a>' +
'  <div class="w3-large w3-margin-top">' +
'      <a style="text-decoration:none;" href="tel:860.874.9733"><i class="fa fa-phone fa-fw w3-hover-text-black w3-xlarge"></i> Phone: +1 860.874.9733</a><br/>' +
'      <a style="text-decoration:none;" href="mailto:info@andrewspringmanart.com" target="_blank"><i class="fa fa-envelope fa-fw w3-hover-text-black w3-xlarge"></i>  Email: info@andrewspringmanart.com</a><br>' +
'    </div>' +
//TODO: social media links
//'  <div class="w3-xlarge w3-section">' +
//'    <i class="fa fa-facebook-official w3-hover-opacity"></i>' +
//'    <i class="fa fa-instagram w3-hover-opacity"></i>' +
//'  </div>' +
'  <p>Powered by <a href="https://getdirectus.com/" title="Directus" target="_blank" class="w3-hover-text-green">Directus</a>, <a href="https://github.com/axios/axios" title="Axios" target="_blank" class="w3-hover-text-green">Axios</a>, and <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>' +
'</footer>';
}

//TEMPLATE ROUTINES (BEGIN)
// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}

// Change style of navbar on scroll
window.onscroll = function() {myFunction()};
function myFunction() {
    var navbar = document.getElementById("myNavbar");
    if (document.body.scrollTop > 10 || document.documentElement.scrollTop > 10) {
        navbar.className = "w3-bar" + " w3-card" + " w3-animate-top" + " w3-white";
    } else {
        navbar.className = navbar.className.replace(" w3-card w3-animate-top w3-white", "");
    }
}

// Used to toggle the menu on small screens when clicking on the menu button
function toggleFunction() {
    var x = document.getElementById("navDemo");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
} 
//TEMPLATE ROUTINES (END)

function getSizes(code) {
  return axios.get(api + 'tables/products/rows?filters[product_artwork][contains]=' + code);
}

function getPiece(code) {
  return axios.get(api + 'tables/artwork/rows?filters[artwork_code][contains]=' + code);
}

function display_piece(artwork_code) {
  axios.all( [getPiece(artwork_code), getSizes(artwork_code)] )
  .then(axios.spread(function (artwork_response, sizes_response) {
    var s = navigation();
    s += page_title(artwork_response.data.data[0].artwork_title);
    s += '<div class="w3-row w3-margin-top w3-margin-bottom w3-center">';
    s += '  <div class="w3-col m12 l12 w3-padding">';
    s += '    <img class="galleryImg" src="' + host + artwork_response.data.data[0].artwork_image.data.url + '"/><br/>';
    s += '    <h4>' + artwork_response.data.data[0].artwork_description + '</h4>';
    s += '  </div>';
    s += '<h3>Sizes and Prices</h3>';
    sizes_response.data.data.forEach(function(element){
      s += '<div>' + element.product_type.data.product_type + ', ';
      s += element.product_type.data.product_type_description + ', ';
      s += 'Price: ' + element.product_type.data.product_type_price  + ' (USD)</div>';
    })
    s += '<p>To order, email or call (see below) and give the title and size.</p></div>';
    s += footer();
    document.getElementById("theBody").innerHTML = s;
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}

function getArticle(id) {
  return axios.get(api + 'tables/news_articles/rows/' + id);
}

function display_article(id) {
  axios.all( [getArticle(id)] )
  .then(axios.spread(function (article_response) {
    var s = navigation();
    s += page_title(article_response.data.data.article_title);
    s += '<div class="w3-row w3-margin-top w3-margin-bottom">';
    s += '  <div class="w3-col m12 l3 w3-padding">';
    s += '    <img class="galleryImg w3-center" src="' + host + article_response.data.data.article_featured_image.data.url + '"/><br/>';
    s += '  </div>';
    s += '  <div class="w3-col m12 l9 w3-padding">';
    s += '    <h4>' + article_response.data.data.article_copy + '</h4>';
    s += '  </div>';
    s += '</div><br/>';
    s += footer();
    document.getElementById("theBody").innerHTML = s;
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}
  
function getBlurb(blurb_name) {
  return axios.get(api + 'tables/blurbs/rows?filters[blurb_name][eq]='+blurb_name);
}

function getArtwork() {
  return axios.get(api + 'tables/artwork/rows');
}

function displayGallery() {	
//TODO: Add at least one more image to gallery
  axios.all([getBlurb('Gallery Blurb'), getArtwork()])
  .then(axios.spread(function (blurb_response, artwork_response) {
    // All requests are now complete
    var s = navigation() + page_title('GALLERY');
    s += text_section(blurb_response.data.data[0].blurb_content);
    s += '<div class="w3-row w3-margin-top w3-margin-bottom w3-center">';
    artwork_response.data.data.reverse().forEach(function(element){
      s += '  <div class="w3-col m12 l4 w3-padding">';
      s += '  <a href="index.html?page=piece&artwork_code=' + element.artwork_code + '"><img class="galleryImg" src="' + host + element.artwork_image.data.url + '"/></a><br/>';
      s += '<h4>' + element.artwork_title + '</h4>';
//      s += element.artwork_description;
//      s += '<a href="index.html?page=piece&artwork_code=' + element.artwork_code + '">Sizes and Prices</a>';
      s += '  </div>';
    })
    s += '</div><br/>';
    s += footer();
    document.getElementById("theBody").innerHTML = s;	
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}

function getFAQs() {
  return axios.get(api + 'tables/faqs/rows?order[faq_category]=asc');
}

function accordionFunction(id) {
  var x = document.getElementById(id);
  if (x.className.indexOf("w3-show") == -1) {
      x.className += " w3-show";
  } else { 
      x.className = x.className.replace(" w3-show", "");
  }
}

function displayFAQs() {	
  axios.all([getBlurb('FAQ Blurb'), getFAQs()])
  .then(axios.spread(function (blurb_response, faq_response) {
    // All requests are now complete
    var s = navigation() + page_title('FAQ');
    var category = '';
    s += text_section(blurb_response.data.data[0].blurb_content);
    s += '<div class="max90">';
    faq_response.data.data.forEach(function(element){
      if (category != element.faq_category.data.faq_category) {
        category = element.faq_category.data.faq_category;
        s += '<h1>' + category + '</h1>';
      }
      s += '<button onclick="accordionFunction(\'faq' + element.id + '\')" class="w3-btn w3-block w3-light-grey w3-left-align w3-wrap faqButton">' + element.faq_question + '</button>';
      s += '<div id="faq' + element.id + '" class="w3-container w3-hide">' + element.faq_answer + '</div>';
    })
    s += '</div><br/>';
    s += footer();
    document.getElementById("theBody").innerHTML = s;	
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}

function getNews() {
  return axios.get(api + 'tables/news_articles/rows');
}

function displayNews() {	
  axios.all([getBlurb('News Blurb'), getNews()])
  .then(axios.spread(function (blurb_response, news_response) {
    // All requests are now complete
    var s = navigation() + page_title('NEWS');
    s += text_section(blurb_response.data.data[0].blurb_content);
    s += '<div class="w3-row w3-margin-top w3-margin-bottom w3-center">';
    news_response.data.data.reverse().forEach(function(element){
      s += '  <div class="w3-col m12 l4 w3-padding">';
      s += '    <a href="index.html?page=article&id=' + element.id + '"><img src="' + host + element.article_featured_image.data.url + '"/></a><br/>';
      s += '    <div>' + element.article_title 		+ '</div>';
      s += '    <div>' + element.teaser 	+ '</div>';
      s += '    <p><a href="index.html?page=article&id=' + element.id + '" class="w3-button w3-white w3-border w3-round-large">View Story</a>'; 
      s += '  </div>';
    })
    s += '</div>';
    s += footer();
    document.getElementById("theBody").innerHTML = s;	
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}

  function getNews() {
  return axios.get(api + 'tables/news_articles/rows');
}

function displayAbout() {	
  //TODO: copy for this page
  axios.all([getBlurb('Artist Blurb')])
  .then(axios.spread(function (blurb_response) {
    // All requests are now complete
    var s = navigation() + page_title('THE ARTIST');
    s += text_section(blurb_response.data.data[0].blurb_content);
    s += footer();
    document.getElementById("theBody").innerHTML = s;	
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}

function page_title(title) {
  return '' +
  '<!-- First Parallax Image with Logo Text -->' +
  '<div class="titleImg w3-display-container w3-opacity-min-off" id="home">' +
  '  <div class="w3-display-middle" style="max-width=90%; white-space:normal;">' +
  '    <span class="w3-center w3-padding w3-camo-black w3-xxlarge w3-wide w3-animate-top">' + title + '</span>' +
  '  </div>' +
  '</div>';
}

function home_logo() {
  return '' +
  '<!-- First Parallax Image with Logo Text -->' +
  '<div class="bgimg-1 w3-display-container w3-opacity-min-off" id="home">' +
  '  <div class="w3-display-middle" style="white-space:normal;">' +
  '    <span class="w3-center w3-padding-large w3-camo-black w3-xxlarge w3-wide w3-animate-top">ANDREW</span><br/><span class="w3-center w3-padding-large w3-camo-black w3-xxlarge w3-wide w3-animate-left">SPRINGMAN</span><br/><span class="w3-center w3-padding-large w3-camo-black w3-xxlarge w3-wide w3-animate-bottom">ART</span>' +
  '  </div>' +
  '</div>';
}

function text_section(blurb) {
  return '' +
  '<!-- Container (About Section) -->' +
  '<div class="w3-row w3-center"><div class="w3-col l12 w3-padding">' +
  '  <h4>' + blurb + '</h4>' +
  '</div></div>';
}

function home_latest(art, news) {
  return '' +
  '<!-- Second Parallax Image with Portfolio Text -->' +
  '<div class="bgimg-2 w3-display-container w3-opacity-min-off">' +
  '  <div class="w3-display-middle">' +
  '    <span class="w3-xxlarge w3-text-camo-black w3-wide">THE LATEST</span>' +
  '  </div>' +
  '</div>' +
  '<!-- Container (Portfolio Section) -->' +
  '<div class="w3-row w3-margin-top w3-margin-bottom w3-center">' +
  '  <div class="w3-col m12 l6 w3-padding">' +
  '    <h3>LATEST ARTWORK</h3>' +
  '    <a href="index.html?page=piece&artwork_code=' + art.artwork_code + '"><img class="w3-image" src="' + host + art.artwork_image.data.url + '"/></a>' +
  '    <h4>' + art.artwork_title + '</h4>' +
  '    <p><a href="index.html?page=piece&artwork_code=' + art.artwork_code + '" class="w3-button w3-white w3-border w3-round-large">Go To Image</a> &nbsp; ' +
  '<a class="w3-button w3-white w3-border w3-round-large" href="index.html?page=gallery">Gallery</a></p>' +
  '  </div>' +
  '    <div class="w3-col m12 l6 w3-padding">' +
  '    <h3>LATEST NEWS</h3>' +
  '      <a href="index.html?page=article&id=' + news.id + '"><img class="w3-image" src="' + host + news.article_featured_image.data.url + '"/></a>' +
  '      <h4>' + news.article_title + '</h4>' + 
  news.teaser +
  '      <p><a href="index.html?page=article&id=' + news.id + '" class="w3-button w3-white w3-border w3-round-large">This Story</a> &nbsp; ' + 
  '<a href="index.html?page=news" class="w3-button w3-white w3-border w3-round-large">More Articles</a></p>' +
  '    </div>' +
  '</div>';
}

function contact_form(home = false) {
  title = home ? '<!-- Third Parallax Image with Portfolio Text -->' +
  '<div class="bgimg-3 w3-display-container w3-opacity-min-off" id="contact">' +
  '  <div class="w3-display-middle">' +
  '     <span class="w3-xxlarge w3-text-camo-black w3-wide">CONTACT</span>' +
  '  </div>' +
  '</div>' : page_title("CONTACT");

  return title +
  '' +
  '<!-- Container (Contact Section) -->' +
  '<div class="w3-content w3-container" >' +
  '  <div class="w3-row  w3-section">' +
  '    <h4>We would love to hear from you!</h4>' +
  '    <div class="w3-panel">' +
  '      <form action="/contact.php" target="_blank">' +
  '        <div class="w3-row-padding" style="margin:0 -16px 8px -16px">' +
  '          <div class="w3-half">' +
  '            <input class="w3-input w3-light-gray" type="text" placeholder="Name" required name="Name">' +
  '          </div>' +
  '          <div class="w3-half">' +
  '            <input class="w3-input w3-light-gray" type="text" placeholder="Email" required name="Email">' +
  '          </div>' +
  '        </div>' +
  '        <textarea style="height:200px" class="w3-input w3-light-gray" type="text" placeholder="Message" required name="Message"></textarea>' +
  '        <button class="w3-button w3-black w3-right w3-section" type="submit">' +
  '          <i class="fa fa-paper-plane"></i> SEND MESSAGE' +
  '        </button>' +
  '      </form>' +
  '    </div>' +
  '  </div>' +
  '</div>';
}

function displayHome() {	
  axios.all([getBlurb('Home Blurb'), getArtwork(), getNews()])
  .then(axios.spread(function (blurb_response, artwork_response, news_response) {
    // All requests are now complete
    var s = navigation(true)
          + home_logo()
          + text_section(blurb_response.data.data[0].blurb_content)
          + home_latest(artwork_response.data.data.pop(), news_response.data.data.pop())
          + contact_form(true)
          + footer();
    document.getElementById("theBody").innerHTML = s;	
  }))
  .catch(function (error) {
      document.getElementById("theBody").innerHTML = error;
  });
}

function displayContact() {	
  var s = navigation()
        + contact_form()
        + footer();
  document.getElementById("theBody").innerHTML = s;	
}

function router() {
  var url = new URL(window.location.href);
  var page = url.searchParams.get("page");
  switch(page) {
      case 'home':
          displayHome();
          break;
      case 'artist':
          displayAbout();
          break;
      case 'gallery':
          displayGallery();
          break;
      case 'news':
          displayNews();
          break;
      case 'faq':
          displayFAQs();
          break;
      case 'contact':
          displayContact();
          break;
      case 'piece':
        var artwork_code = url.searchParams.get("artwork_code");
        if (artwork_code == '') {
          displayHome();
        } else {
          display_piece(artwork_code);
        }
        break;
      case 'article':
        var id = url.searchParams.get("id");
        if (id == '') {
          displayHome();
        } else {
          display_article(id);
        }
        break;
      default:
          displayHome();
  }
}

router();

</script>
</body>
</html>
